---
title: Authentication
sidebar_position: 8
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# üîê Authentication Guide

To interact with our API, users must authenticate via **Microsoft Entra ID** (formerly Azure Active Directory), which is included in all **Microsoft 365 tenants**.

This guide walks you through how to:
- Register an app in Microsoft Entra
- Acquire an Access token
- Use that token to authenticate requests to the **SILstat‚Ñ¢ API**

---

## üßæ Prerequisites

---

Before you begin:

- You must have a **Microsoft 365 tenant**
- Access to the **Microsoft Entra admin center** ([entra.microsoft.com](https://entra.microsoft.com))

---

## üìå Overview

---

To fully support Microsoft Entra Identity Provider the customer registers the exida Licensing Entra Enterprise Application and supporting applications depending on what exida software they have within their Microsoft Tenant.  

![exida Tenant Diagram](/img/exida-tenant-diagram.png)

Registering allows the customer to manage which identities have access to exida software and enable existing investments in identity management to be respected. Using this approach no secrets need to be exchanged, and no access is needed by the exida team to the customer‚Äôs Identity Provider.

![exida Verification Diagram](/img/exida-verification-diagram.png)

exida‚Äôs Authorization and Authentication process involves users‚Äô requesting to sign-in to the relevant exida Software Application at which point the user is redirected to their matching Customer Tenant by the Microsoft Entra platform. Once redirected a special Access Token and Identity Token are generated for the user. These tokens are used by the exida to verify the identity of the user. 

To ensure that only valid customer sign-in requests are allowed, the exida team will verify each customer‚Äôs email domain(s) and uniquely identify each Customer Tenant. 

![exida Verify Tenant Diagram](/img/exida-verify-tenant-diagram.png)

---

## üìù Registering exida‚Äôs Entra Enterprise Apps 

---

Registering Entra Enterprise Applications allows the customer to manage and secure their identities effectively and efficiently. This ensures that exida fulfils its requirements under applicable standards for: 

1. **Governance:** Registering allows the customer to manage all aspects of the identities without sharing secrets with exida. The customer has full control over governing which identities are allowed to sign-in. 

2. **Enhanced Security:** By treating identity as the primary security perimeter, Entra Enterprise Applications help protect against unauthorized access. Features like multi-factor authentication (MFA), conditional access policies, and role-based access control (RBAC) enhance security measures and are managed by the customer. 

3. **Improved User Experience:** Single sign-on (SSO) capabilities provided by Entra Enterprise Applications simplify access for users, reducing the need for multiple passwords and improving productivity. 

To register the exida Entra Enterprise Applications an IT administrator (or similar) with sufficient permissions to manage the Customer‚Äôs Entra Tenant invokes CLI (Command-Line Interface) commands that registers all exida Enterprise Applications. This is the recommended approach by the Microsoft Entra Tenant team as the customer can review the script and follow their cybersecurity policies.  

---

## üè∑Ô∏è Entra Enterprise Apps for registration 

---

The following Entra Enterprise Applications are to be registered by the Customer, please note that the order in which they are registered is important. 

To support any exida software the following two Applications are required: 

| Application Name | Application URI | Application GUID | Purpose |
|------------------|-----------------|------------------|---------|
| **exida Licensing API** | api://api.identity.licensing.innovation.exida.com | 216a3aa5-33e3-4d8c-bfdd-a8cb2e845a38 | Supports API access to Licensing for exida software and enables supporting API access to the Licensing Portal. |
| **exida Licensing** | api://identity.licensing.innovation.exida.com | fa02c858-f4f3-42e9-90ad-b07a0543a531 | Supports sign-in to the Licensing Portal and allows customer maintenance of License and Licensing information. |

If the customer has SILstat‚Ñ¢ licenses, they require the following Applications to be registered: 

| Application Name | Application Id | Application GUID | Purpose |
|------------------|----------------|------------------|---------|
| **exida SILstat API** | api://api.identity.silstat.innovation.exida.com | 46230ff1-4f58-459e-9a2d-a3811d5b8836 | Supports direct API access and enables supporting API access to SILstat. |
| **exida SILstat** | api://identity.silstat.innovation.exida.com | 969b1815-326d-4f78-bfe7-d2b4f665af39 | Supports sign-in to SILstat and all its supporting applications (Dashboard, Admin, Support and Docs). |

If the customer has exSILentia¬Æ licenses and they wish to support in app SSO, they require the following Application to be registered: 

| Application Name | Application Id | Application GUID | Purpose |
|------------------|----------------|------------------|---------|
| **exida exSILentia** | api://identity.exsilentia.innovation.exida.com | 695b0d51-e15b-4129-b8b7-925194e54418 | Supports SSO for exSILentia applications (SILAlarm, Cyber, Functional Safety, SERH) and all its supporting modules. |

> **Note:** Certain exSILentia¬Æ Licenses allow offline activation which only require the customer to access the exida Licensing Portal. 

---

## üñ•Ô∏è Script Template 

---

The script template for registering Entra Applications can be done with either Azure CLI or Azure PowerShell. 

### üßæ Script Prerequisites

Before running the script in this section, please ensure your environment is set up correctly. These prerequisites ensure that the script runs smoothly and can authenticate with your Microsoft 365 (Microsoft Entra) tenant.

---

### ‚úÖ Requirements

- **Azure CLI Installed**

  The script relies on the Azure CLI for interacting with Microsoft Entra ID. You can use it in PowerShell or your favorite terminal.

  - [Install the Azure CLI](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli)
  
    ```powershell
    # On Windows you can use
    winget install --exact --id Microsoft.AzureCLI
    ```

  - Verify installation:

    ```powershell
    az --version
    ```

### üöÄ Running the Script

**Sign into Azure (using az login)**

You must be signed in to your Microsoft 365 tenant to perform authenticated operations.

```powershell
az login

# If you don't have an Azure Subscription you can use this version:
az login --allow-no-subscriptions
```

**Set the $appId = 'Id' variable**

Set the Application Id, based on your use case, choose the appropriate `Application Id` from the table above. Refer to [Entra Enterprise Apps for registration](#entra-enterprise-apps-for-registration).

```powershell
# The Application Id from the above table
$appId = '<YOUR_SELECTED_APPLICATION_ID>'
```

**Register the Enterprise Application**

Once you‚Äôve set the `appId`, you can run the command to register the application.

```powershell
az ad sp create
 --id $appId `
 --query id `
 --output tsv
```

 **Register multiple Enterprise Applications**

 You can register multiple Enterprise Applications using a `foreach` loop in Powershell by iterating through a list of `appId` values:

```powershell
# List of all exida's Entra Applications that need to be registered
$appIds = @(
    # Licensing Core
    '216a3aa5-33e3-4d8c-bfdd-a8cb2e845a38',
    'fa02c858-f4f3-42e9-90ad-b07a0543a531',
    # SILstat (Optional)
    '46230ff1-4f58-459e-9a2d-a3811d5b8836',
    '969b1815-326d-4f78-bfe7-d2b4f665af39',
    # exSILentia (Optional)
    '695b0d51-e15b-4129-b8b7-925194e54418'
)

foreach ($appId in $appIds) {
    # Registering the Enterprise Application (Service Principal)
    # See https://learn.microsoft.com/en-us/cli/azure/ad/sp
    az ad sp create --id $appId `
        --query id `
        --output tsv
    # To confirm the app is registered use this command
    az ad sp list --filter "appId eq $appId"
}
```

If you make a mistake, you can always remove an application via:

```powershell
az ad sp delete --id $appId
```

For more information about managing service principals with the Azure CLI, see the official Microsoft documentation:

üîó [Learn more about `az ad sp`](https://learn.microsoft.com/en-us/cli/azure/ad/sp)

---

## üéüÔ∏è Fetching an Access Token

---

Once your application is registered and the correct permissions are configured, you can fetch an access token using the Azure CLI.

This method uses the identity of the signed-in user and does not require a client secret.

---

### ‚úÖ Step 1: Sign in to your tenant

```bash
az login --tenant <YOUR_TENANT_ID>
```

### ‚úÖ Step 2: Get an access token
```powershell
$resourceURI = "api://<YOUR_CLIENT_ID>"
$tenantId = "<YOUR_TENANT_ID>"

$token = az account get-access-token --resource $resourceURI --tenant $tenantId | ConvertFrom-Json

$token.accessToken
```

> üîé **Note:** Replace the placeholders with your actual values.

---

### üîê Use the token in API requests

Once you've retrieved the access token, you can use it to authenticate your API requests.

Include the token in the `Authorization` header using the **Bearer** scheme, like so:

<Tabs>
<TabItem value="bash" label="CURL">

```bash
curl -H "Authorization: Bearer <YOUR_ACCESS_TOKEN>" -H "SelectedOrganizationId: <YOUR_SELECTED_ORGANIZATION>" \
  https://api.silstat.exsilentia.com/api
```

</TabItem>
<TabItem value="powershell" label="Powershell">

```powershell
$headers = @{
  Authorization = "Bearer <YOUR_ACCESS_TOKEN>"
  # SelectedOrganizationId = "YOUR_SELECTED_ORGANIZATION" # Optional
}

Invoke-RestMethod -Uri "https://api.silstat.exsilentia.com/api" -Headers $headers
```

</TabItem>
</Tabs>

> üí° **Note:** The SelectedOrganizationId is necessary in multi-organization scenarios. If your tenant only has one organization, this header is not required. If the `SelectedOrganizationId` header is not provided, the API defaults to the last used Organization. 
